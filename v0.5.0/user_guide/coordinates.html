

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    
        <title>Coordinate conversions | Boule v0.5.0</title>
    

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=12168cd1" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/coordinates';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Defining custom ellipsoids" href="defining_ellipsoids.html" />
    <link rel="prev" title="Gravity disturbances" href="gravity_disturbance.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Boule <span class="project-version">v0.5.0</span></p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="normal_gravity.html">Normal gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="gravity_disturbance.html">Gravity disturbances</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Coordinate conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="defining_ellipsoids.html">Defining custom ellipsoids</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">List of functions and classes (API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/boule.Ellipsoid.html">boule.Ellipsoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/boule.Sphere.html">boule.Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/boule.TriaxialEllipsoid.html">boule.TriaxialEllipsoid</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../ellipsoids.html">Available ellipsoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing Boule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compatibility.html">Version compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Documentation for other versions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://www.fatiando.org/contact">Join the community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/boule/blob/main/CONTRIBUTING.md">How to contribute</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/boule/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/boule">Source code on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.fatiando.org">The Fatiando a Terra project</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fatiando/boule" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fatiando/boule/edit/main/doc/user_guide/coordinates.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fatiando/boule/issues/new?title=Issue%20on%20page%20%2Fuser_guide/coordinates.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/user_guide/coordinates.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Coordinate conversions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geodetic-to-geocentric-spherical">Geodetic to geocentric spherical</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geodetic-to-geocentric-spherical-using-pymap3d">Geodetic to geocentric spherical using pymap3d</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geocentric-spherical-to-geodetic">Geocentric spherical to geodetic</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="coordinate-conversions">
<span id="coordinates"></span><h1>Coordinate conversions<a class="headerlink" href="#coordinate-conversions" title="Link to this heading">#</a></h1>
<section id="geodetic-to-geocentric-spherical">
<h2>Geodetic to geocentric spherical<a class="headerlink" href="#geodetic-to-geocentric-spherical" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../api/generated/boule.Ellipsoid.html#boule.Ellipsoid" title="boule.Ellipsoid"><code class="xref py py-class docutils literal notranslate"><span class="pre">boule.Ellipsoid</span></code></a> class implements coordinate conversions between
geocentric geodetic coordinates and geocentric spherical coordinates. Both are
common in geophysical applications when dealing with spherical harmonics or
spherical modeling of topography.</p>
<p>The example below will show you how to convert geodetic latitude and height
into geocentric spherical latitude and radius.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boule</span> <span class="k">as</span> <span class="nn">bl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">longitude</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">481_000</span>  <span class="c1"># ICESat-2 orbit height in meters</span>

<span class="n">longitude_sph</span><span class="p">,</span> <span class="n">latitude_sph</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">WGS84</span><span class="o">.</span><span class="n">geodetic_to_spherical</span><span class="p">(</span>
    <span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodetic longitude:&quot;</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spherical longitude:&quot;</span><span class="p">,</span> <span class="n">longitude_sph</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodetic latitude:&quot;</span><span class="p">,</span> <span class="n">latitude</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spherical latitude:&quot;</span><span class="p">,</span> <span class="n">latitude_sph</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Height (m):&quot;</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radius (m):&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Geodetic longitude: 40
Spherical longitude: 40
Geodetic latitude: [-90.         -85.90909091 -81.81818182 -77.72727273 -73.63636364
 -69.54545455 -65.45454545 -61.36363636 -57.27272727 -53.18181818
 -49.09090909 -45.         -40.90909091 -36.81818182 -32.72727273
 -28.63636364 -24.54545455 -20.45454545 -16.36363636 -12.27272727
  -8.18181818  -4.09090909   0.           4.09090909   8.18181818
  12.27272727  16.36363636  20.45454545  24.54545455  28.63636364
  32.72727273  36.81818182  40.90909091  45.          49.09090909
  53.18181818  57.27272727  61.36363636  65.45454545  69.54545455
  73.63636364  77.72727273  81.81818182  85.90909091  90.        ]
Spherical latitude: [-90.         -85.88354756 -81.76762011 -77.65273153 -73.53937377
 -69.42800654 -65.31904771 -61.21286467 -57.10976692 -53.00999983
 -48.91373991 -44.82109151 -40.73208506 -36.6466769  -32.56475052
 -28.4861193  -24.41053065 -20.33767131 -16.26717386 -12.19862422
  -8.13156991  -4.06552908   0.           4.06552908   8.13156991
  12.19862422  16.26717386  20.33767131  24.41053065  28.4861193
  32.56475052  36.6466769   40.73208506  44.82109151  48.91373991
  53.00999983  57.10976692  61.21286467  65.31904771  69.42800654
  73.53937377  77.65273153  81.76762011  85.88354756  90.        ]
Height (m): 481000
Radius (m): [6837752.31424518 6837862.00852276 6838188.80559622 6838725.89905453
 6839462.11303663 6840382.14963168 6841466.92578056 6842693.99069968
 6844038.01293238 6845471.32464188 6846964.50972863 6848487.02178921
 6850007.81781446 6851495.99381081 6852921.40916165 6854255.28745742
 6855470.78263883 6856543.50054635 6857451.9672834  6858178.03712615
 6858707.23400555 6859029.02182043 6859137.         6859029.02182043
 6858707.23400555 6858178.03712615 6857451.9672834  6856543.50054635
 6855470.78263883 6854255.28745742 6852921.40916165 6851495.99381081
 6850007.81781446 6848487.02178921 6846964.50972863 6845471.32464188
 6844038.01293238 6842693.99069968 6841466.92578056 6840382.14963169
 6839462.11303663 6838725.89905453 6838188.80559622 6837862.00852276
 6837752.31424518]
</pre></div>
</div>
</div>
</div>
<p>Notice that:</p>
<ol class="arabic simple">
<li><p>The longitude is the same in both coordinates systems.</p></li>
<li><p>The latitude is slightly different except for the poles and equator.</p></li>
<li><p>The radius (distance from the center of the ellipsoid) varies even though
the height is constant.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We used the WGS84 ellipsoid here but the workflow is the same for any
other oblate ellipsoid. Checkout <a class="reference internal" href="../ellipsoids.html#ellipsoids"><span class="std std-ref">Available ellipsoids</span></a> for options.</p>
</div>
</section>
<section id="geodetic-to-geocentric-spherical-using-pymap3d">
<h2>Geodetic to geocentric spherical using pymap3d<a class="headerlink" href="#geodetic-to-geocentric-spherical-using-pymap3d" title="Link to this heading">#</a></h2>
<p>Boule’s <a class="reference internal" href="../api/generated/boule.Ellipsoid.html#boule.Ellipsoid" title="boule.Ellipsoid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ellipsoid</span></code></a> and <a class="reference internal" href="../api/generated/boule.Sphere.html#boule.Sphere" title="boule.Sphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sphere</span></code></a> classes can be
used with <a class="reference external" href="https://github.com/geospace-code/pymap3d/">pymap3d</a> for
converting between different coordinate systems.
While pymap3d defines some ellipsoids internally, you may want to use one from
Boule if:</p>
<ul class="simple">
<li><p>You want to be certain that the parameters used for coordinate conversions
and gravity calculations are consistent.</p></li>
<li><p>You need to <a class="reference internal" href="defining_ellipsoids.html#defining-ellipsoids"><span class="std std-ref">define your own ellipsoid</span></a>, either
because you need different parameters than the built-in ones or they aren’t
available in either Boule or pymap3d.</p></li>
</ul>
<p>The example below converts between geodetic and geocentric spherical using
<code class="docutils literal notranslate"><span class="pre">pymap3d.geodetic2spherical</span></code> instead of
<a class="reference internal" href="../api/generated/boule.Ellipsoid.html#boule.Ellipsoid.geodetic_to_spherical" title="boule.Ellipsoid.geodetic_to_spherical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">boule.Ellipsoid.geodetic_to_spherical</span></code></a> to achieve the same outcome as
in the previous example.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymap3d</span>

<span class="n">longitude</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">481_000</span>  <span class="c1"># ICESat-2 orbit height in meters</span>

<span class="n">latitude_sph</span><span class="p">,</span> <span class="n">longitude_sph</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">pymap3d</span><span class="o">.</span><span class="n">geodetic2spherical</span><span class="p">(</span>
    <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="n">bl</span><span class="o">.</span><span class="n">WGS84</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodetic longitude:&quot;</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spherical longitude:&quot;</span><span class="p">,</span> <span class="n">longitude_sph</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodetic latitude:&quot;</span><span class="p">,</span> <span class="n">latitude</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spherical latitude:&quot;</span><span class="p">,</span> <span class="n">latitude_sph</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Height (m):&quot;</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radius (m):&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Geodetic longitude: 40
Spherical longitude: 40.0
Geodetic latitude: [-90.         -85.90909091 -81.81818182 -77.72727273 -73.63636364
 -69.54545455 -65.45454545 -61.36363636 -57.27272727 -53.18181818
 -49.09090909 -45.         -40.90909091 -36.81818182 -32.72727273
 -28.63636364 -24.54545455 -20.45454545 -16.36363636 -12.27272727
  -8.18181818  -4.09090909   0.           4.09090909   8.18181818
  12.27272727  16.36363636  20.45454545  24.54545455  28.63636364
  32.72727273  36.81818182  40.90909091  45.          49.09090909
  53.18181818  57.27272727  61.36363636  65.45454545  69.54545455
  73.63636364  77.72727273  81.81818182  85.90909091  90.        ]
Spherical latitude: [-90.         -85.88354756 -81.76762011 -77.65273153 -73.53937377
 -69.42800654 -65.31904771 -61.21286467 -57.10976692 -53.00999983
 -48.91373991 -44.82109151 -40.73208506 -36.6466769  -32.56475052
 -28.4861193  -24.41053065 -20.33767131 -16.26717386 -12.19862422
  -8.13156991  -4.06552908   0.           4.06552908   8.13156991
  12.19862422  16.26717386  20.33767131  24.41053065  28.4861193
  32.56475052  36.6466769   40.73208506  44.82109151  48.91373991
  53.00999983  57.10976692  61.21286467  65.31904771  69.42800654
  73.53937377  77.65273153  81.76762011  85.88354756  90.        ]
Height (m): 481000
Radius (m): [6837752.31424518 6837862.00852276 6838188.80559622 6838725.89905453
 6839462.11303663 6840382.14963169 6841466.92578056 6842693.99069968
 6844038.01293239 6845471.32464188 6846964.50972864 6848487.02178921
 6850007.81781447 6851495.99381081 6852921.40916165 6854255.28745742
 6855470.78263883 6856543.50054635 6857451.9672834  6858178.03712615
 6858707.23400555 6859029.02182044 6859137.         6859029.02182044
 6858707.23400555 6858178.03712615 6857451.9672834  6856543.50054635
 6855470.78263883 6854255.28745742 6852921.40916165 6851495.99381081
 6850007.81781447 6848487.02178921 6846964.50972864 6845471.32464188
 6844038.01293239 6842693.99069968 6841466.92578056 6840382.14963169
 6839462.11303663 6838725.89905453 6838188.80559622 6837862.00852276
 6837752.31424518]
</pre></div>
</div>
</div>
</div>
</section>
<section id="geocentric-spherical-to-geodetic">
<h2>Geocentric spherical to geodetic<a class="headerlink" href="#geocentric-spherical-to-geodetic" title="Link to this heading">#</a></h2>
<p>Another common coordinate conversion used in global studies is from geocentric
spherical to geodetic coordinates. The example below demonstrate this
conversion using the Cartesian coordinates of the
<a class="reference external" href="https://en.wikipedia.org/wiki/InSight">Insight lander</a> on Mars from
<a class="reference internal" href="../references.html#lemaistre2023" id="id1"><span>[LeMaistre2023]</span></a> and the Martian ellipsoid defined in Boule.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boule</span> <span class="k">as</span> <span class="nn">bl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">xyz</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2_417_504.5</span><span class="p">,</span> <span class="mf">2_365_954.5</span><span class="p">,</span> <span class="mf">266_266.7</span><span class="p">]</span>  <span class="c1"># InSight lander coordinates</span>

<span class="c1"># convert Cartesian to geocentric spherical</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
<span class="n">latitude_sph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])))</span>
<span class="n">longitude_sph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">mars_ellipsoid</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">Mars2009</span>

<span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">mars_ellipsoid</span><span class="o">.</span><span class="n">spherical_to_geodetic</span><span class="p">(</span>
  <span class="n">longitude_sph</span><span class="p">,</span> <span class="n">latitude_sph</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Geodetic longitude: </span><span class="si">{</span><span class="n">longitude</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Geodetic latitude: </span><span class="si">{</span><span class="n">latitude</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ellipsoidal height (m): </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Geodetic longitude: 135.6174366918431
Geodetic latitude: 4.548092430561262
Ellipsoidal height (m): -2241.5527252679644
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="gravity_disturbance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gravity disturbances</p>
      </div>
    </a>
    <a class="right-next"
       href="defining_ellipsoids.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Defining custom ellipsoids</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geodetic-to-geocentric-spherical">Geodetic to geocentric spherical</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geodetic-to-geocentric-spherical-using-pymap3d">Geodetic to geocentric spherical using pymap3d</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geocentric-spherical-to-geodetic">Geocentric spherical to geodetic</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, The Boule Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Oct 22, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>